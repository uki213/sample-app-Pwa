{"version":3,"sources":["webpack:///./src/components/pages/Index/Camera.vue?4da3","webpack:///./src/components/pages/Index/Camera.vue?f9ab","webpack:///src/components/pages/Index/Camera.vue","webpack:///./src/components/pages/Index/Camera.vue?94f6","webpack:///./src/components/pages/Index/Camera.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_m","attrs","on","$event","$emit","resultImage","staticRenderFns","staticClass","setup","handleSuccess","stream","previewVideo","srcObject","virtualCanvas","width","videoWidth","height","context","drawImage","imageData","document","getElementById","navigator","mediaDevices","setInterval","previewBufferData","value","component"],"mappings":"2IAAA,yBAA6kB,EAAG,G,yCCAhlB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACJ,EAAIM,GAAG,GAAGF,EAAG,MAAM,CAACA,EAAG,MAAM,CAACG,MAAM,CAAC,IAAM,0BAA0BC,GAAG,CAAC,MAAQ,SAASC,GAAQT,EAAIU,MAAM,QAASV,EAAIW,wBACnOC,EAAkB,CAAC,WAAa,IAAIZ,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACS,YAAY,eAAe,CAACT,EAAG,QAAQ,CAACS,YAAY,gBAAgBN,MAAM,CAAC,GAAK,UAAU,SAAW,U,YC2BzN,kBACEO,MADF,WAEI,IAAJ,EACA,qBAEI,SAASC,EAAcC,GACrBC,EAAaC,UAAYF,EAiB3B,SAASL,IACP,IAAN,mCACMQ,EAAcC,MAAQH,EAAaI,WACnCF,EAAcG,OAASL,EAAaI,WAEpC,IAAN,qBACME,EAAQC,UACd,EACA,EACA,EACA,aACA,eAEM,IAAN,+BACM,OAAOC,EAOT,OAnCA,OAAJ,OAAI,EAAJ,WACMR,EAAeS,SAASC,eAAe,WACvCC,UAAUC,aAChB,cACQ,MAAR,CACU,MAAV,CAAY,IAAZ,KAAY,MAAZ,KAAY,IAAZ,MACU,OAAV,CAAY,IAAZ,IAAY,MAAZ,IAAY,IAAZ,MACU,UAAV,GACU,WAAV,CAAY,MAAZ,kBAGA,WAoBIC,aAAY,WACVC,EAAkBC,MAAQrB,MAChC,IAEW,CACLoB,kBAAN,EACMpB,YAAN,MC1E8W,I,wBCQ1WsB,EAAY,eACd,EACAlC,EACAa,GACA,EACA,KACA,WACA,MAIa,aAAAqB,E","file":"js/chunk-3668e231.075b2c89.js","sourcesContent":["import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Camera.vue?vue&type=style&index=0&id=7daf1fea&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Camera.vue?vue&type=style&index=0&id=7daf1fea&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_vm._m(0),_c('div',[_c('img',{attrs:{\"src\":\"img/ui/shutterMark.svg\"},on:{\"click\":function($event){_vm.$emit('click', _vm.resultImage())}}})])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"previewWrap\"},[_c('video',{staticClass:\"previewBuffer\",attrs:{\"id\":\"preview\",\"autoplay\":\"\"}})])}]\n\nexport { render, staticRenderFns }","<!--\n カメラの操作はjsフレームワークでも直接browserの機能を呼ぶ必要がある。\n このコンポーネントでは、mediaDevicesを用いてカメラのプレビュー及び、\n キャプチャショットを取得し、emitでそのキャプチャショットを返却することで、\n vue.jsのエコシステムに乗せている。\n-->\n\n<template>\n  <section>\n    <div class=\"previewWrap\">\n      <video\n        id=\"preview\"\n        class=\"previewBuffer\"\n        autoplay\n      />\n    </div>\n    <div>\n      <img\n        src=\"img/ui/shutterMark.svg\"\n        @click=\"$emit('click', resultImage())\"\n      >\n    </div>\n  </section>\n</template>\n\n<script>\nimport { defineComponent, onMounted, ref } from '@vue/composition-api'\n\nexport default defineComponent({\n  setup() {\n    let previewVideo\n    const previewBufferData = ref('')\n\n    function handleSuccess(stream) {\n      previewVideo.srcObject = stream\n    }\n\n    onMounted(() => {\n      previewVideo = document.getElementById('preview')\n      navigator.mediaDevices\n        .getUserMedia({\n          video: {\n            width: { min: 1024, ideal: 1280, max: 1920 },\n            height: { min: 776, ideal: 720, max: 1080 },\n            frameRate: 10,\n            facingMode: { exact: 'environment' }\n          }\n        })\n        .then(handleSuccess)\n    })\n\n    function resultImage() {\n      const virtualCanvas = document.createElement('canvas')\n      virtualCanvas.width = previewVideo.videoWidth\n      virtualCanvas.height = previewVideo.videoWidth\n\n      const context = virtualCanvas.getContext('2d')\n      context.drawImage(\n        previewVideo,\n        0,\n        0,\n        previewVideo.videoWidth,\n        previewVideo.videoHeight\n      )\n      const imageData = virtualCanvas.toDataURL('image/jpeg', 0.8)\n      return imageData\n    }\n\n    setInterval(() => {\n      previewBufferData.value = resultImage()\n    }, 50)\n\n    return {\n      previewBufferData,\n      resultImage\n    }\n  }\n})\n</script>\n\n<style lang=\"scss\" scoped>\nsection {\n  padding-top: 44px;\n  text-align: center;\n  .previewWrap {\n    margin: auto;\n    width: 320px;\n    height: 320px;\n    position: relative;\n    overflow: hidden;\n    .previewBuffer {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: auto;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Camera.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Camera.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Camera.vue?vue&type=template&id=7daf1fea&scoped=true&\"\nimport script from \"./Camera.vue?vue&type=script&lang=js&\"\nexport * from \"./Camera.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Camera.vue?vue&type=style&index=0&id=7daf1fea&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7daf1fea\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}